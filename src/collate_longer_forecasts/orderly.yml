script: collate_longer_forecasts.R
artefacts:
  data:
    description: Collated model outputs (quantiles)
    filenames:
    - unwtd_projections_qntls.rds
    - wtd_per_country_projections_qntls.rds
    - unwtd_ps_qntls.rds
    - wtd_per_country_ps_qntls.rds
    - unwtd_reff_qntls.rds
    - wtd_per_country_reff_qntls.rds
    - unwtd_reff_qntls_with_underreporting.rds
    - wtd_per_country_reff_qntls_with_underreporting.rds
    - no_ps_projections_qntls.rds
packages:
- dplyr
- tidyr
- ggdist
- ggplot2
- rincewind
- purrr
- glue
- gridExtra
depends:
- produce_longer_forecasts:
    id: latest(parameter:week_ending == "2020-11-01"  && parameter:use_si == "si_2")
    use:
      unweighted_pred_qntls_2020-11-01.rds: unweighted_pred_qntls.rds
      weighted_per_country_pred_qntls_2020-11-01.rds: weighted_per_country_pred_qntls.rds
      unweighted_reff_qntls_2020-11-01.rds: unweighted_reff_qntls.rds
      unweighted_ps_qntls_2020-11-01.rds: unweighted_ps_qntls.rds
      weighted_per_country_ps_qntls_2020-11-01.rds: weighted_per_country_ps_qntls.rds
      weighted_per_country_reff_qntls_2020-11-01.rds: weighted_per_country_reff_qntls.rds
      unweighted_reff_with_underreporting_2020-11-01.rds: unweighted_reff_with_underreporting.rds
      weighted_per_country_reff_with_underreporting_2020-11-01.rds: weighted_per_country_reff_with_underreporting.rds
- produce_longer_forecasts:
    id: latest(parameter:week_ending == "2020-11-08"  && parameter:use_si == "si_2")
    use:
      unweighted_pred_qntls_2020-11-08.rds: unweighted_pred_qntls.rds
      weighted_per_country_pred_qntls_2020-11-08.rds: weighted_per_country_pred_qntls.rds
      unweighted_reff_qntls_2020-11-08.rds: unweighted_reff_qntls.rds
      unweighted_ps_qntls_2020-11-08.rds: unweighted_ps_qntls.rds
      weighted_per_country_ps_qntls_2020-11-08.rds: weighted_per_country_ps_qntls.rds
      weighted_per_country_reff_qntls_2020-11-08.rds: weighted_per_country_reff_qntls.rds
      unweighted_reff_with_underreporting_2020-11-08.rds: unweighted_reff_with_underreporting.rds
      weighted_per_country_reff_with_underreporting_2020-11-08.rds: weighted_per_country_reff_with_underreporting.rds
- produce_longer_forecasts:
    id: latest(parameter:week_ending == "2020-11-15"  && parameter:use_si == "si_2")
    use:
      unweighted_pred_qntls_2020-11-15.rds: unweighted_pred_qntls.rds
      weighted_per_country_pred_qntls_2020-11-15.rds: weighted_per_country_pred_qntls.rds
      unweighted_reff_qntls_2020-11-15.rds: unweighted_reff_qntls.rds
      unweighted_ps_qntls_2020-11-15.rds: unweighted_ps_qntls.rds
      weighted_per_country_ps_qntls_2020-11-15.rds: weighted_per_country_ps_qntls.rds
      weighted_per_country_reff_qntls_2020-11-15.rds: weighted_per_country_reff_qntls.rds
      unweighted_reff_with_underreporting_2020-11-15.rds: unweighted_reff_with_underreporting.rds
      weighted_per_country_reff_with_underreporting_2020-11-15.rds: weighted_per_country_reff_with_underreporting.rds
- produce_longer_forecasts:
    id: latest(parameter:week_ending == "2020-11-22"  && parameter:use_si == "si_2")
    use:
      unweighted_pred_qntls_2020-11-22.rds: unweighted_pred_qntls.rds
      weighted_per_country_pred_qntls_2020-11-22.rds: weighted_per_country_pred_qntls.rds
      unweighted_reff_qntls_2020-11-22.rds: unweighted_reff_qntls.rds
      unweighted_ps_qntls_2020-11-22.rds: unweighted_ps_qntls.rds
      weighted_per_country_ps_qntls_2020-11-22.rds: weighted_per_country_ps_qntls.rds
      weighted_per_country_reff_qntls_2020-11-22.rds: weighted_per_country_reff_qntls.rds
      unweighted_reff_with_underreporting_2020-11-22.rds: unweighted_reff_with_underreporting.rds
      weighted_per_country_reff_with_underreporting_2020-11-22.rds: weighted_per_country_reff_with_underreporting.rds
- produce_longer_forecasts:
    id: latest(parameter:week_ending == "2020-11-29"  && parameter:use_si == "si_2")
    use:
      unweighted_pred_qntls_2020-11-29.rds: unweighted_pred_qntls.rds
      weighted_per_country_pred_qntls_2020-11-29.rds: weighted_per_country_pred_qntls.rds
      unweighted_reff_qntls_2020-11-29.rds: unweighted_reff_qntls.rds
      unweighted_ps_qntls_2020-11-29.rds: unweighted_ps_qntls.rds
      weighted_per_country_ps_qntls_2020-11-29.rds: weighted_per_country_ps_qntls.rds
      weighted_per_country_reff_qntls_2020-11-29.rds: weighted_per_country_reff_qntls.rds
      unweighted_reff_with_underreporting_2020-11-29.rds: unweighted_reff_with_underreporting.rds
      weighted_per_country_reff_with_underreporting_2020-11-29.rds: weighted_per_country_reff_with_underreporting.rds
- produce_longer_forecasts_no_ps:
    id: latest(parameter:week_ending == "2020-11-01"  && parameter:use_si == "si_2")
    use:
      no_ps_2020-11-01.rds: weighted_per_country_pred_qntls.rds
- produce_longer_forecasts_no_ps:
    id: latest(parameter:week_ending == "2020-11-08"  && parameter:use_si == "si_2")
    use:
      no_ps_2020-11-08.rds: weighted_per_country_pred_qntls.rds
- produce_longer_forecasts_no_ps:
    id: latest(parameter:week_ending == "2020-11-15"  && parameter:use_si == "si_2")
    use:
      no_ps_2020-11-15.rds: weighted_per_country_pred_qntls.rds
- produce_longer_forecasts_no_ps:
    id: latest(parameter:week_ending == "2020-11-22"  && parameter:use_si == "si_2")
    use:
      no_ps_2020-11-22.rds: weighted_per_country_pred_qntls.rds
- produce_longer_forecasts_no_ps:
    id: latest(parameter:week_ending == "2020-11-29"  && parameter:use_si == "si_2")
    use:
      no_ps_2020-11-29.rds: weighted_per_country_pred_qntls.rds
- prepare_ecdc_data:
    id: latest
    use:
      latest_deaths_wide_no_filter.rds: latest_deaths_wide_no_filter.rds
